insert into ibsdb.quality_result select '现网基站数量',case spcode when 0 then 1 when 1 then 2 else spcode end spcode,cast(value as varchar) value,day from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type = 'uli_count' and  spcode in (0,1,3) order by spcode ;
insert into ibsdb.quality_result select '基站未关联数量',case spcode when 0 then 1 when 1 then 2 else spcode end spcode,cast(value as varchar) value,day from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type = 'uli_not' and  spcode in (0,1,3) order by spcode;
insert into ibsdb.quality_result select '基站共用数量',spcode,cast(value as varchar) value,day from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type = 'uli_common' and  spcode in (1,2,3) order by spcode;
insert into ibsdb.quality_result select '外省基站数量',spcode,cast(value as varchar) value,day from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type = 'uli_out_country' and  spcode in (1,2,3) order by spcode;
insert into ibsdb.quality_result select '基站非460和ci错误数量',spcode,cast(value as varchar) value,day from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type = 'uli_error' and  spcode in (1,2,3) order by spcode;
insert into ibsdb.quality_result select '正常基站未关联率',spcode, concat(cast(value as varchar),'%') value,data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select tab_not_com_out.spcode, tab_not_com_out.value/(tab_count.value * 1.0000)*100 value from (select tab_not_com.spcode spcode, tab_not_com.value - tab_out.value value from  (select tab_not.spcode spcode, tab_not.value - tab_com.value value from (select case spcode when 0 then 1 when 1 then 2 else spcode end spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type = 'uli_not' and  spcode in (0,1,3) ) tab_not join (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type = 'uli_common' and  spcode in (1,2,3) ) tab_com on tab_not.spcode = tab_com.spcode) tab_not_com join (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type = 'uli_out_country' and  spcode in (1,2,3) ) tab_out on tab_not_com.spcode = tab_out.spcode) tab_not_com_out join (select case spcode when 0 then 1 when 1 then 2 else spcode end spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type = 'uli_count' and  spcode in (0,1,3)) tab_count on tab_not_com_out.spcode=tab_count.spcode ) tab_result order by spcode;

insert into ibsdb.quality_result select case type when 'cdr_machine' then 'cdr设备输出' when 'ybrz_machine' then 'ybrz设备输出' end type, spcode,cast(value as varchar) value,day from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd')  and type like '%machine' order by type,spcode;

insert into ibsdb.quality_result select '手机号未加86' type,c_producer,cast(count(1) as varchar) value,data_format(current_timestamp - interval '1' day,'yyyyMMdd') from original.t_cdr_k where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and regexp_like(c_usernum,'^(1)([3-9][0-9][0-9]{4}[0-9a-zA-Z]{8})$') and c_imsi like '460%' group by c_producer;

insert into ibsdb.quality_result select '短信内容为空' type,c_producer,cast(count(1) as varchar) value,data_format(current_timestamp - interval '1' day,'yyyyMMdd') from original.t_cdr_k_sms where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and c_content = '' group by c_producer;


insert into ibsdb.quality_result select 'cdr_数据总条数',spcode,cast(value as varchar) value,data_format(current_timestamp - interval '1' day,'yyyyMMdd') from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and spcode in (1,2,3) and type='cdr_count' ;

insert into ibsdb.quality_result select 'cdr_msisdn去重条数',spcode,cast(value as varchar) value,data_format(current_timestamp - interval '1' day,'yyyyMMdd') from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and spcode in (1,2,3) and type='cdr_msisdn_distinct' ;

insert into ibsdb.quality_result select 'cdr通联条数',spcode,cast(value as varchar) value,data_format(current_timestamp - interval '1' day,'yyyyMMdd') from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type='cdr_communication' ;

insert into ibsdb.quality_result select 'cdr未知运营商条数',spcode,cast(value as varchar) value,data_format(current_timestamp - interval '1' day,'yyyyMMdd') from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type='cdr_spcode' ;

insert into ibsdb.quality_result select 'cdr_msisdn填充率',cdr_part.spcode,CONCAT(cast(ROUND(cdr_part.value*100/(cdr_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_msisdn' )  cdr_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_count') cdr_count on cdr_part.spcode = cdr_count.spcode;

insert into ibsdb.quality_result select 'cdr_imsi填充率',cdr_part.spcode,CONCAT(cast(ROUND(cdr_part.value*100/(cdr_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_imsi' )  cdr_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_count') cdr_count on cdr_part.spcode = cdr_count.spcode;

insert into ibsdb.quality_result select 'cdr_imei填充率',cdr_part.spcode,CONCAT(cast(ROUND(cdr_part.value*100/(cdr_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_imei' )  cdr_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_count') cdr_count on cdr_part.spcode = cdr_count.spcode;

insert into ibsdb.quality_result select 'cdr_三码全填充率',cdr_part.spcode,CONCAT(cast(ROUND(cdr_part.value*100/(cdr_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_three_code' )  cdr_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_count') cdr_count on cdr_part.spcode = cdr_count.spcode;

insert into ibsdb.quality_result select 'cdr_三码都为空率',cdr_part.spcode,CONCAT(cast(ROUND(cdr_part.value*100/(cdr_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_three_code_empty' )  cdr_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_count') cdr_count on cdr_part.spcode = cdr_count.spcode;

insert into ibsdb.quality_result select 'cdr_uli填充率',cdr_part.spcode,CONCAT(cast(ROUND(cdr_part.value*100/(cdr_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_uli' )  cdr_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_count') cdr_count on cdr_part.spcode = cdr_count.spcode;

insert into ibsdb.quality_result select 'cdr_areacode填充率',cdr_part.spcode,CONCAT(cast(ROUND(cdr_part.value*100/(cdr_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_areacode' )  cdr_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_count') cdr_count on cdr_part.spcode = cdr_count.spcode;

insert into ibsdb.quality_result select 'cdr_homecode填充率',cdr_part.spcode,CONCAT(cast(ROUND(cdr_part.value*100/(cdr_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_homecode' )  cdr_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_count') cdr_count on cdr_part.spcode = cdr_count.spcode;

insert into ibsdb.quality_result select 'cdr_type类型合法率',cdr_part.spcode,CONCAT(cast(ROUND(cdr_part.value*100/(cdr_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_type' )  cdr_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_count') cdr_count on cdr_part.spcode = cdr_count.spcode;

insert into ibsdb.quality_result select 'cdr_ascode不合法数量',spcode,cast(value as varchar) value,day from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type = 'cdr_ascode' and  spcode in (1,2,3) order by spcode;

insert into ibsdb.quality_result select 'cdr_relatenum填充率',cdr_part.spcode,CONCAT(cast(ROUND(cdr_part.value*100/(cdr_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_relatenum' )  cdr_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_communication') cdr_count on cdr_part.spcode = cdr_count.spcode;

insert into ibsdb.quality_result select 'cdr_rspcode填充率',cdr_part.spcode,CONCAT(cast(ROUND(cdr_part.value*100/(cdr_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_rspcode' )  cdr_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_communication') cdr_count on cdr_part.spcode = cdr_count.spcode;

insert into ibsdb.quality_result select 'cdr_rhomecode填充率',cdr_part.spcode,CONCAT(cast(ROUND(cdr_part.value*100/(cdr_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_rhomecode' )  cdr_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='cdr_communication') cdr_count on cdr_part.spcode = cdr_count.spcode;

insert into ibsdb.quality_result select 'ybrz_数据总条数',case spcode when 2 then 3 when 3 then 2 else spcode end,cast(value as varchar) value,data_format(current_timestamp - interval '1' day,'yyyyMMdd') from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type='ybrz_count' and  spcode in (1,2,3);

insert into ibsdb.quality_result select 'ybrz_msisdn去重条数',case spcode when 2 then 3 when 3 then 2 else spcode end,cast(value as varchar) value,data_format(current_timestamp - interval '1' day,'yyyyMMdd') from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type='ybrz_msisdn_distinct' ;

insert into ibsdb.quality_result select 'ybrz未知运营商条数',case spcode when 2 then 3 when 3 then 2 else spcode end,cast(value as varchar) value,data_format(current_timestamp - interval '1' day,'yyyyMMdd') from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and type='ybrz_spcode' ;

insert into ibsdb.quality_result select 'ybrz_msisdn填充率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_msisdn' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_count') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;

insert into ibsdb.quality_result select 'ybrz_imsi填充率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_imsi' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_count') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;

insert into ibsdb.quality_result select 'ybrz_imei填充率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_imei' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_count') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;

insert into ibsdb.quality_result select 'ybrz_三码全填充率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_three_code' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_count') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;

insert into ibsdb.quality_result select 'ybrz_三码都为空率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_three_code_empty' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_count') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;

insert into ibsdb.quality_result select 'ybrz_uli填充率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_uli' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_count') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;

insert into ibsdb.quality_result select 'ybrz_url填充率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_url' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_http') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;


insert into ibsdb.quality_result select 'ybrz_busstype填充率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_busstype' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_count') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;

insert into ibsdb.quality_result select 'ybrz_源IP填充率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_sip' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_count') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;

insert into ibsdb.quality_result select 'ybrz_目的IP填充率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_dip' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_count') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;

insert into ibsdb.quality_result select 'ybrz_c_l5_proto合法率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_l5' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_count') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;

insert into ibsdb.quality_result select 'ybrz_areacode填充率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_araecode' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_count') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;

insert into ibsdb.quality_result select 'ybrz_homecode填充率',case ybrz_part.spcode when 2 then 3 when 3 then 2 else ybrz_part.spcode end,CONCAT(cast(ROUND(ybrz_part.value*100/(ybrz_count.count*1.00),4) as varchar),'%'),data_format(current_timestamp - interval '1' day,'yyyyMMdd') from (select spcode,value from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_homecode' )  ybrz_part  join (select spcode,value as count from ibsdb.quality where day=data_format(current_timestamp - interval '1' day,'yyyyMMdd') and  spcode in (1,2,3) and type='ybrz_count') ybrz_count on ybrz_part.spcode = ybrz_count.spcode;

